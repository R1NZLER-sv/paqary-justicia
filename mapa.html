<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Paqary Justicia - Jueces de Paz</title>

  <!-- CSS de Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    header {
      background-color: #111827;
      color: #f9fafb;
      padding: 16px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    #container {
      display: flex;
      flex: 1;
      height: calc(100vh - 60px); /* Altura menos el header */
    }

    #map {
      flex: 1;
      height: 100%;
    }

    #sidebar {
      max-width: 350px;
      padding: 16px;
      background: #f9fafb;
      border-right: 1px solid #e5e7eb;
      overflow-y: auto;
    }

    .zone-card {
      background-color: #ffffff;
      padding: 12px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      margin-bottom: 12px;
    }

    .zone-card h3 {
      font-size: 16px;
      margin: 0 0 8px;
      color: #3b82f6;
    }

    .zone-card p {
      font-size: 14px;
      margin: 4px 0;
      color: #374151;
    }
  </style>
</head>
<body>
  <!-- Encabezado con el título -->
  <header>
    Paqary Justicia
  </header>
  <div id="container">
    <div id="map"></div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js"></script>
  <!-- Leaflet -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    // Configurar Firebase (reemplaza con tus credenciales)
    const firebaseConfig = {
      apiKey: "TU_API_KEY",
      authDomain: "TU_AUTH_DOMAIN",
      projectId: "TU_PROJECT_ID",
      storageBucket: "TU_STORAGE_BUCKET",
      messagingSenderId: "TU_MESSAGING_SENDER_ID",
      appId: "TU_APP_ID"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore(app);

    // Inicializar el mapa
    const map = L.map('map').setView([-16.3989, -71.535], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    // Cargar zonas desde Firebase y visualización
    const loadZonesFromFirestore = async () => {
      const zonesSnapshot = await db.collection("zones").get();

      zonesSnapshot.forEach(doc => {
        const zone = doc.data();
        const polygon = L.polygon(JSON.parse(zone.coordinates), {
          color: "blue",
          fillOpacity: 0.5,
          weight: 2
        }).addTo(map);

        // Mostrar Popup con detalles
        polygon.bindPopup(`
          <div>
            <h3 style="color: #3b82f6; margin: 0;">${zone.name}</h3>
            <p><strong>Provincia:</strong> ${zone.province}</p>
            <p><strong>Juez:</strong> ${zone.judge}</p>
            <p><strong>Correo:</strong> ${zone.email}</p>
            <p><strong>Teléfono:</strong> ${zone.phone}</p>
          </div>
        `);
      });
    };

    // Cargar las zonas al abrir el mapa
    loadZonesFromFirestore();
  </script>
</body>
</html>